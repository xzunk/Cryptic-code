document.addEventListener('DOMContentLoaded',()=>{const inputText=document.getElementById('inputText');const resultText=document.getElementById('resultText');const successMessage=document.getElementById('successMessage');const copyButton=document.getElementById('copyButton');const clearButton=document.getElementById('clearButton');const downloadButton=document.getElementById('downloadButton');function generateRandomPrefix(){const characters='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';const length=8;let prefix='';for(let i=0;i<length;i++){const randomIndex=Math.floor(Math.random()*characters.length);prefix+=characters.charAt(randomIndex)}
return prefix}
function encrypt(text){const secretKey=generateRandomPrefix();const encrypted=CryptoJS.AES.encrypt(text,secretKey).toString();const prefix=generateRandomPrefix();return `${prefix}:${encrypted}:${secretKey}`}
function decrypt(encrypted){const parts=encrypted.split(':');const prefix=parts[0];const decryptedText=parts.slice(1,-1).join(':');const secretKey=parts.slice(-1)[0];const decryptedBytes=CryptoJS.AES.decrypt(decryptedText,secretKey);const decrypted=decryptedBytes.toString(CryptoJS.enc.Utf8);return decrypted}
function copyToClipboard(element){element.select();element.setSelectionRange(0,99999);document.execCommand('copy');window.getSelection().removeAllRanges()}
function clearText(){inputText.value='';resultText.value='';successMessage.classList.add('hidden')}
function downloadText(filename,text){const element=document.createElement('a');element.setAttribute('href','data:text/plain;charset=utf-8,'+encodeURIComponent(text));element.setAttribute('download',filename);element.style.display='none';document.body.appendChild(element);element.click();document.body.removeChild(element)}
inputText.addEventListener('input',()=>{const text=inputText.value.trim();if(text.includes(':')){const decrypted=decrypt(text);resultText.value=decrypted}else{const encrypted=encrypt(text);resultText.value=encrypted}
successMessage.classList.add('hidden')});copyButton.addEventListener('click',()=>{copyToClipboard(resultText);successMessage.classList.remove('hidden')});clearButton.addEventListener('click',clearText);downloadButton.addEventListener('click',()=>{const filename='result.txt';const text=resultText.value;downloadText(filename,text)})})